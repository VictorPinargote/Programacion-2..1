<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        
        <record id="mail_template_book_loan_overdue" model="mail.template">
            
            <field name="name">Notificación: Devolución de libro atrasada</field>
            <field name="model_id" ref="biblioteca.model_biblioteca_prestamo"/>
            
            <field name="subject">[Aviso Biblioteca] Préstamo Vencido: ${object.name}</field>
            <field name="email_from">${(user.company_id.email_formatted or 'noreply@localhost') | safe}</field>
            <field name="email_to">${object.usuario_id.mail or ''}</field>
            <field name="description">Notificación enviada cuando un préstamo excede la fecha máxima de devolución.</field>
            
            <field name="body_html" type="html">
                <div style="background-color:#f4f4f4; padding: 20px 0; font-family:Verdana, Arial, sans-serif; color:#454748; font-size: 14px;">
                    <table align="center" cellpadding="0" cellspacing="0" width="600" style="background-color: #ffffff; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-collapse: separate;">
                        
                        <tbody>
                            <tr>
                                <td style="padding: 30px 40px;">
                                    <p style="font-size: 16px; line-height: 1.6;">
                                        Estimado/a <strong><t t-esc="object.usuario_id.nombre_usuario or 'Usuario'"/></strong>,
                                    </p>
                                    <p style="font-size: 16px; line-height: 1.6;">
                                        Le contactamos para recordarle que su préstamo <strong><t t-esc="object.name"/></strong> ha vencido.
                                    </p>
                                    
                                    <p style="font-size: 16px; line-height: 1.6;">
                                        La fecha límite de entrega era el <strong><t t-out="format_datetime(object.fecha_maxima, tz=user.tz)"/></strong>.
                                    </p>
                                    
                                    <p style="font-size: 16px; line-height: 1.6;">
                                        Los libros asociados a este préstamo son:
                                    </p>
                                    
                                    <ul style="font-size: 16px; line-height: 1.8;">
                                        <t t-foreach="object.libros_prestados_id" t-as="libro">
                                            <li><strong><t t-esc="libro.nombre_libro"/></strong></li>
                                        </t>
                                    </ul>
                                    
                                    <p style="font-size: 16px; line-height: 1.6;">
                                        Por favor, realice la devolución lo antes posible.
                                    </p>
                                    <br/>
                                    <p style="font-size: 16px;">
                                        Saludos cordiales,<br/>
                                        <em>El equipo de <t t-esc="user.company_id.name or 'la Biblioteca'"/></em>
                                    </p>
                                </td>
                            </tr>
                        </tbody>
                        
                        <tr>
                            <td align="center" style="background-color: #f9f9f9; padding: 20px; border-bottom-left-radius: 6px; border-bottom-right-radius: 6px; font-size: 12px; color: #888;">
                                <t t-esc="user.company_id.name or 'Tu Biblioteca'"/>
                            </td>
                        </tr>
                    </table>
                </div>
            </field>
            <field name="auto_delete" eval="True"/> 
        </record>
        
    </data>
</odoo>